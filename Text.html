<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizador de Disciplina</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        table {
            width: 100%;
            max-width: 600px;
            border-collapse: collapse;
            background-color: #1e1e1e;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #333;
        }
        th {
            background-color: #333;
            font-weight: 600;
        }
        tr:hover {
            background-color: #2c2c2c;
        }
        .button-container {
            margin-top: 20px;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
            color: #e0e0e0;
            background-color: #6200ea;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3700b3;
        }
    </style>
</head>
<body>

<h1>Organizador de Disciplina</h1>

<!-- Popup para pedir nome da disciplina -->
<script>
    let nomeDisciplina = prompt("Nome da disciplina:");
</script>

<!-- Tabela de tópicos -->
<table id="tabela-topicos">
    <thead>
        <tr>
            <th>Enumeração</th>
            <th>Nome do Tópico</th>
            <th>Tempo Estimado</th>
        </tr>
    </thead>
    <tbody>
        <!-- Linhas de exemplo iniciais -->
        <script>
            for (let i = 1; i <= 10; i++) {
                document.write(`
                    <tr>
                        <td>${i}</td>
                        <td onclick="abrirPopup(${i})">Clique para adicionar</td>
                        <td id="tempo${i}">-</td>
                    </tr>
                `);
            }
        </script>
    </tbody>
</table>

<!-- Botões para adicionar e salvar -->
<div class="button-container">
    <button onclick="adicionarLinha()">+</button>
    <button onclick="gerarMarkdown()">Salvar</button>
</div>

<!-- Script para adicionar funcionalidade -->
<script>
    let contador = 10;

    // Função para adicionar uma nova linha
    function adicionarLinha() {
        contador++;
        const tabela = document.getElementById("tabela-topicos").getElementsByTagName('tbody')[0];
        const novaLinha = tabela.insertRow();
        novaLinha.innerHTML = `
            <td>${contador}</td>
            <td onclick="abrirPopup(${contador})">Clique para adicionar</td>
            <td id="tempo${contador}">-</td>
        `;
    }

    // Função para abrir pop-up de edição de tópico
    function abrirPopup(indice) {
        const popup = window.open("", "popup", "width=400,height=400");
        popup.document.write(`
            <!DOCTYPE html>
            <html lang="pt-BR">
            <head>
                <title>Edição do Tópico</title>
                <style>
                    body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: #121212; color: #e0e0e0; text-align: center; padding: 20px; }
                    button { padding: 10px 20px; font-size: 16px; color: #e0e0e0; background-color: #6200ea; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; }
                    button:hover { background-color: #3700b3; }
                </style>
            </head>
            <body>
                <h2>Edição do Tópico ${indice}</h2>
                <button onclick="window.opener.editarNome(${indice})">Editar Nome</button>
                <button onclick="window.opener.abrirMatriz(${indice}); window.close();">Matriz de Variáveis</button>
            </body>
            </html>
        `);
    }

    // Função para editar o nome do tópico
    function editarNome(indice) {
        const novoNome = prompt("Digite o novo nome do tópico:");
        if (novoNome) {
            document.getElementById("tabela-topicos").rows[indice].cells[1].innerText = novoNome;
        }
    }

    // Função para abrir matriz de variáveis
    function abrirMatriz(indice) {
        const popup = window.open("", "matriz", "width=600,height=600");
        popup.document.write(`
            <!DOCTYPE html>
            <html lang="pt-BR">
            <head>
                <title>Matriz de Variáveis</title>
                <style>
                    body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: #121212; color: #e0e0e0; text-align: center; padding: 20px; }
                    button { padding: 10px 20px; font-size: 16px; color: #e0e0e0; background-color: #6200ea; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; }
                    button:hover { background-color: #3700b3; }
                    table { margin-top: 20px; width: 100%; max-width: 400px; border-collapse: collapse; }
                    th, td { padding: 10px; border: 1px solid #333; }
                    th { background-color: #333; }
                </style>
            </head>
            <body>
                <h2>Matriz de Variáveis</h2>
                <table>
                    <thead>
                        <tr><th>Variável</th><th>Valor</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Complexidade</td><td><select id="complexidade"><option>0</option><option>1</option><option>2</option></select></td></tr>
                        <tr><td>Quantidade de Material</td><td><select id="material"><option>0</option><option>1</option><option>2</option></select></td></tr>
                        <tr><td>Conhecimento</td><td><select id="conhecimento"><option>0</option><option>1</option><option>2</option></select></td></tr>
                        <tr><td>Agenda</td><td><select id="agenda"><option>0</option><option>1</option><option>2</option></select></td></tr>
                        <tr><td>Informação</td><td><select id="informacao"><option>0</option><option>1</option><option>2</option></select></td></tr>
                    </tbody>
                </table>
                <button onclick="window.opener.calcularTempo(${indice}, document.getElementById('complexidade').value, document.getElementById('material').value, document.getElementById('conhecimento').value, document.getElementById('agenda').value, document.getElementById('informacao').value); window.close();">Calcular Dias</button>
            </body>
            </html>
        `);
    }

    // Função para calcular o tempo estimado e atualizar na tabela
    function calcularTempo(indice, complexidade, material, conhecimento, agenda, informacao) {
        let resultado = (parseInt(complexidade) + parseInt(material) + parseInt(informacao)) * 2;
        resultado -= (parseInt(conhecimento) * 0.25 * resultado);
        resultado -= (parseInt(agenda) * 0.25 * resultado);
        document.getElementById(`tempo${indice}`).innerText = `${resultado.toFixed(2)} dias`;
    }

    // Função para gerar Markdown com os dados da tabela
    function gerarMarkdown() {
        let markdown = `# ${nomeDisciplina}\n\n| Enumeração | Nome do Tópico | Tempo Estimado |\n|------------|----------------|----------------|\n`;
        const linhas = document.querySelectorAll("#tabela-topicos tbody tr");
        linhas.forEach(linha => {
            const cols = linha.querySelectorAll("td");
            markdown += `| ${cols[0].innerText} | ${cols[1].innerText} | ${cols[2].innerText} |\n`;
        });
        console.log(markdown);  // Para depuração, o Markdown será exibido no console
        alert("Markdown gerado. Veja no console.");
    }
</script>

</body>
</html>

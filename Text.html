<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página da Disciplina</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            max-width: 600px;
            border-collapse: collapse;
            background-color: #1e1e1e;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #333;
        }
        th {
            background-color: #333;
            font-weight: 600;
        }
        tr:hover {
            background-color: #2c2c2c;
        }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            color: #e0e0e0;
            background-color: #6200ea;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        #mdOutput {
            margin-top: 20px;
            padding: 10px;
            background-color: #1e1e1e;
            color: #e0e0e0;
            white-space: pre-wrap;
            border-radius: 8px;
            width: 100%;
            max-width: 600px;
        }
    </style>
</head>
<body>
    <h1 id="disciplinaTitle">Nome da Disciplina</h1>
    <table id="topicoTable">
        <thead>
            <tr>
                <th>Enumeração</th>
                <th>Nome do Tópico</th>
                <th>Tempo Estimado</th>
            </tr>
        </thead>
        <tbody>
            <!-- Linhas serão geradas aqui -->
        </tbody>
    </table>
    <button onclick="adicionarLinha()">+</button>
    <button onclick="gerarMarkdown()">Salvar</button>
    <pre id="mdOutput"></pre>

    <script>
        let contadorEnum = 10;

        // Exibe o prompt de Nome da Disciplina
        document.addEventListener('DOMContentLoaded', () => {
            const nomeDisciplina = prompt('Nome da disciplina:');
            document.getElementById('disciplinaTitle').innerText = nomeDisciplina || 'Disciplina';
        });

        // Função para adicionar linha
        function adicionarLinha() {
            const tabela = document.getElementById('topicoTable').getElementsByTagName('tbody')[0];
            const novaLinha = tabela.insertRow();
            const celulaEnum = novaLinha.insertCell(0);
            const celulaNome = novaLinha.insertCell(1);
            const celulaTempo = novaLinha.insertCell(2);

            celulaEnum.textContent = ++contadorEnum;
            celulaNome.innerHTML = `<span onclick="abrirPopUp('${contadorEnum}')">Clique para editar</span>`;
            celulaTempo.textContent = ''; // Placeholder para o tempo estimado
        }

        // Pop-up para edição do Nome do Tópico e acesso à Matriz de Variáveis
        function abrirPopUp(enumValue) {
            const escolha = confirm('Deseja editar o Nome do Tópico ou abrir a Matriz de Variáveis? OK para editar, Cancelar para abrir Matriz.');
            if (escolha) {
                const novoNome = prompt('Novo nome do tópico:');
                if (novoNome) {
                    document.querySelector(`#topicoTable tbody tr:nth-child(${enumValue}) td:nth-child(2)`).textContent = novoNome;
                }
            } else {
                abrirMatrizVariaveis(enumValue);
            }
        }

        // Abrir Matriz de Variáveis
        function abrirMatrizVariaveis(enumValue) {
            const novaJanela = window.open('', '_blank');
            novaJanela.document.write(`
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Matriz de Variáveis</title>
                    <style> /* Mesma estilização da matriz de variáveis fornecida */ </style>
                </head>
                <body>
                    <h1>Matriz de Variáveis</h1>
                    <table>
                        <thead><tr><th>Variável</th><th>Valor</th></tr></thead>
                        <tbody>
                            <!-- Tabela de variáveis com inputs de seleção -->
                        </tbody>
                    </table>
                    <button onclick="calcularDias()">Calcular Dias</button>
                    <p id="resultado"></p>
                    <button onclick="window.opener.atualizarTempoEstimado(${enumValue}, resultado.innerText); window.close();">Salvar</button>
                </body>
                <script>
                    function calcularDias() {
                        const resultado = "Exemplo de cálculo";
                        document.getElementById('resultado').textContent = resultado;
                    }
                </script>
                </html>
            `);
        }

        // Atualizar coluna "Tempo Estimado" na tabela principal
        function atualizarTempoEstimado(enumValue, tempoEstimado) {
            const linha = document.querySelector(`#topicoTable tbody tr:nth-child(${enumValue})`);
            linha.cells[2].textContent = tempoEstimado;
        }

        // Geração de Markdown
        function gerarMarkdown() {
            let markdown = `# ${document.getElementById('disciplinaTitle').innerText}\n\n| Enumeração | Nome do Tópico | Tempo Estimado |\n|------------|----------------|----------------|\n`;
            const linhas = document.querySelectorAll('#topicoTable tbody tr');
            linhas.forEach(linha => {
                const enumValue = linha.cells[0].textContent;
                const nomeTopico = linha.cells[1].textContent;
                const tempoEstimado = linha.cells[2].textContent || 'N/A';
                markdown += `| ${enumValue} | ${nomeTopico} | ${tempoEstimado} |\n`;
            });
            document.getElementById('mdOutput').textContent = markdown;
        }
    </script>
</body>
</html>
